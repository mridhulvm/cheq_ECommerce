{% extends 'store/base.html' %}
{% load static %}
{% block content %}


 <!--====== App Content ======-->
 <div class="app-content">

    <!--====== Section 1 ======-->
    <div class="u-s-p-y-60">

        <!--====== Section Content ======-->
        <div class="section__content">
            <div class="container">
                <div class="breadcrumb">
                    <div class="breadcrumb__wrap">
                        <ul class="breadcrumb__list">
                            <li class="has-separator">

                                <a href="{% url 'home' %}">Home</a></li>
                            <li class="is-marked">

                                <a href="">Signup</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--====== End - Section 1 ======-->


    <!--====== Section 2 ======-->
    <div class="u-s-p-b-60">

        <!--====== Section Intro ======-->
        <div class="section__intro u-s-m-b-60">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="section__text-wrap">
                            <h1 class="section__heading u-c-secondary">CREATE AN ACCOUNT</h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--====== End - Section Intro ======-->


        <!--====== Section Content ======-->
        <div class="section__content">
            <div class="container">
                <div class="row row--center">
                    <div class="col-lg-6 col-md-8 u-s-m-b-30">
                        <div class="l-f-o">
                            <div class="l-f-o__pad-box">
                                <h1 class="gl-h1">PERSONAL INFORMATION</h1>


                                    <div class="u-s-m-b-30">

                                        <label class="gl-label" for="reg-fname">FIRST NAME *</label>

                                        <input class="input-text input-text--primary-style" onkeyup="first_name_validate()" type="text" name="first_name" id="first_name" placeholder="First Name" required>
                                        <p style="color:red" id="first_name_error"></p>

                                    </div>
                                    <div class="u-s-m-b-30">

                                        <label class="gl-label" for="reg-lname">LAST NAME *</label>

                                        <input class="input-text input-text--primary-style" onkeyup="last_name_validate()" type="text" name= "last_name"  id="last_name" placeholder="Last Name" required>
                                        <p style="color:red" id="last_name_error"></p>

                                    </div>
                                   
                                    <div class="u-s-m-b-30">

                                        <label class="gl-label" for="reg-email">E-MAIL *</label>

                                        <input class="input-text input-text--primary-style" onkeyup="emailvalidate()" type="email" name= "email" id="email" placeholder="Enter E-mail" required>
                                        <p style="color:red" id="email_error"></p>

                                    </div>
                                    <div class="u-s-m-b-30">

                                        <label class="gl-label" for="reg-email">PHONE NUMBER *</label>

                                        <input class="input-text input-text--primary-style" onkeyup="phonevalidation()" type="tel" pattern="[0-9]{10}" name= "phone_number" id="phone_number" placeholder="Enter Phone Number" required>
                                        <p style="color:red" id="phone_number_error"></p>

                                    </div>
                                    <div class="u-s-m-b-30">

                                        <label class="gl-label" for="reg-password">PASSWORD *</label>

                                        <input class="input-text input-text--primary-style" onkeyup="password_required()" type="password" name= "password" id="password" placeholder="Enter Password" required>
                                        <p style="color:red" id="password_error"></p>

                                    </div>
                                    <div class="u-s-m-b-30">

                                        <label class="gl-label" for="reg-password">CONFIRM PASSWORD *</label>

                                        <input class="input-text input-text--primary-style" onkeyup="password_confirm_required()" type="password" name= "confirm_password" id="confirm_password" placeholder="Confirm Password" required>
                                        <p style="color:red" id="confirm_password_error"></p>

                                    </div>

                                        <p style="color:red" id="display_error"></p>



                                    <div class="u-s-m-b-15">

                                        <button class="btn btn--e-transparent-brand-b-2" id="submit" >CREATE</button></div>

                                        <p >Have an account? <a class="gl-link" href=" {% url 'login' %}">Sign In</a></p>
                                    <!-- <a class="gl-link" href="#">Return to Store</a> -->
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--====== End - Section Content ======-->
    </div>
    <!--====== End - Section 2 ======-->
</div>
<!--====== End - App Content ======-->
<script>
    $('#submit').click(function(){

    var email=$('#email').val()
    var password=$('#password').val()
    var first_name=$('#first_name').val()
    var last_name=$('#last_name').val()
    var phone_number=$('#phone_number').val()

    var name_regex=/^[a-zA-Z ]{1,30}$/;
                
        var first_name_from_input =document.getElementById('first_name').value
        if (name_regex.test(first_name_from_input)){
            document.getElementById('first_name_error').innerHTML=""
            first_name_input=true
            console.log("firstname",first_name_input)

        }
        else{
            document.getElementById('first_name_error').innerHTML="not valid name"
            first_name_input=false
            console.log("firstname",first_name_input)

        }
                
    var last_name_from_input =document.getElementById('last_name').value

        if (name_regex.test(last_name_from_input)){
            document.getElementById('last_name_error').innerHTML=""
            last_name_input=true
            console.log(name)

        }
        else{
            document.getElementById('last_name_error').innerHTML="not valid name"
            last_name_input=false
        }    
    var email_val=document.getElementById('email').value

    var email_regex=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/
        if (email_regex.test(email_val)){

            document.getElementById('email_error').innerHTML=""
            email_check=true

        }
        else{

            document.getElementById('email_error').innerHTML="invalid mail id"
            email_check=false
        }    
    var phone_number=document.getElementById('phone_number').value
    var phone_regex=/^\d{10}$/
    var phone_name_regex=/^[a-zA-Z ]{1,30}$/;

    var phone_number_check_alphabet=document.getElementById('phone_number').value
    lastIndex = phone_number_check_alphabet.length;
    phone_number_check_alphabet = phone_number_check_alphabet[lastIndex - 1] //get first element for checking last inputed element is alphabet

        if(phone_name_regex.test(phone_number_check_alphabet)){

        document.getElementById('phone_number_error').innerHTML="Phone number only allows digits"
        phone_number_input=false

        }              
        else if (phone_regex.test(phone_number)){
            document.getElementById('phone_number_error').innerHTML=""
            phone_number_input=true

        }
        
        else if(phone_number.length<10){

            document.getElementById('phone_number_error').innerHTML="Phone number less than 10 is not valid"
            phone_number_input=false

        }
        else if(phone_number.length<10){

            document.getElementById('phone_number_error').innerHTML="Phone number less than 10 is not valid"
            phone_number_input=false

        }
        else if(phone_number.length>10){
            document.getElementById('phone_number_error').innerHTML="Phone number greater than 10 is not valid"
            phone_number_input=false
        }
        else{
            document.getElementById('phone_number_error').innerHTML="enter valid phone number"
        } 
    var pass=document.getElementById('password').value
        if(pass==""){

            document.getElementById('password_error').innerHTML="password required"
            password_check=false

        }
        else{

            document.getElementById('password_error').innerHTML=""

            password_check=true
        }

    var confirm_pass=document.getElementById('confirm_password').value

        if(confirm_pass==""){

            document.getElementById('confirm_password_error').innerHTML="password confirm required"
            confirm_password_check=false

        }
        else if(confirm_pass != pass){

            document.getElementById('confirm_password_error').innerHTML="password mismatch"
            confirm_password_check=false

        }            
        else{

            document.getElementById('confirm_password_error').innerHTML=""

            confirm_password_check=true
        }
        
        if (email_check == true && password_check == true){
            document.getElementById('display_error').innerHTML=""

        }   
                        
//===============================================================ajax start
if( email_check== true && password_check == true && first_name_input == true && last_name_input == true && phone_number_input == true && confirm_password_check ==true)
    {
        $.ajax({
            url:"{% url 'signup' %}",
            method: 'post',
            data: {'email':email,'password':password,'first_name':first_name,'last_name':last_name,'phone_number':phone_number,'csrfmiddlewaretoken': '{{ csrf_token }}'},
            dataType: 'json',
            success: function (data) {

            console.log(data)
            if(data.status){         

                $('#display_error').html() ;
                alert(data.message) ;   
                window.location.href = ("{% url 'login'  %}");
                           
            }else{
                $('#display_error').html(data.message) ;   
            }

            },
            error: function(error){
              console.log("Ajax cant send data")
            }
        })//ajax end
     
    }
    else{
        document.getElementById('display_error').innerHTML="Enter Valid Credentials"

    }
})
///click function ended=====================================
// form validation====================================
            var email_check=false
            var password_check = false
            var first_name_input = false
            var last_name_input = false
            var phone_number_input = false
            var confirm_password_check = false

            

            function first_name_validate(){

                var name_regex=/^[a-zA-Z ]{1,30}$/;
                
                var first_name_from_input =document.getElementById('first_name').value
                if (name_regex.test(first_name_from_input)){
                    document.getElementById('first_name_error').innerHTML=""
                    first_name_input=true
                    console.log("firstname",first_name_input)

                }
                else{
                    document.getElementById('first_name_error').innerHTML="not valid name"
                    first_name_input=false
                    console.log("firstname",first_name_input)

                }

            }
            

            function last_name(){
                var name_regex=/^[a-zA-Z ]{1,30}$/;
                
                var last_name_from_input =document.getElementById('last_name').value

                if (name_regex.test(last_name_from_input)){
                    document.getElementById('last_name_error').innerHTML=""
                    last_name_input=true
                    console.log(name)

                }
                else{
                    document.getElementById('last_name_error').innerHTML="not valid name"
                    last_name_input=false
                }

            }            
      function phonevalidation(){
            var phone_number=document.getElementById('phone_number').value
            var phone_regex=/^\d{10}$/
            var phone_name_regex=/^[a-zA-Z ]{1,30}$/;
            var phone_number_check_alphabet=document.getElementById('phone_number').value
            lastIndex = phone_number_check_alphabet.length;
            phone_number_check_alphabet = phone_number_check_alphabet[lastIndex - 1] 

            if(phone_name_regex.test(phone_number_check_alphabet)){

            document.getElementById('phone_number_error').innerHTML="Phone number only allows digits"
            phone_number_input=false

            }              
            else if (phone_regex.test(phone_number)){
                document.getElementById('phone_number_error').innerHTML=""
                phone_number_input=true

            }
          
            else if(phone_number.length<10){

                document.getElementById('phone_number_error').innerHTML="Phone number less than 10 is not valid"
                phone_number_input=false

            }
            else if(phone_number.length<10){

                document.getElementById('phone_number_error').innerHTML="Phone number less than 10 is not valid"
                phone_number_input=false

            }
            else if(phone_number.length>10){
                document.getElementById('phone_number_error').innerHTML="Phone number greater than 10 is not valid"
                phone_number_input=false
            }
            else{
                document.getElementById('phone_number_error').innerHTML="enter valid phone number"
            }
        }

        function emailvalidate(){
                // console.log("email validate function")
                var email_val=document.getElementById('email').value

                var email_regex=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/
                if (email_regex.test(email_val)){

                    document.getElementById('email_error').innerHTML=""
                    email_check=true

                }
                else{

                    document.getElementById('email_error').innerHTML="invalid mail id"
                    email_check=false
                }
            }


            function password_required(){
            var pass=document.getElementById('password').value
            if(pass==""){

                document.getElementById('password_error').innerHTML="password required"
                password_check=false

            }
            else{

                document.getElementById('password_error').innerHTML=""

                password_check=true
            }


        }    

        function password_confirm_required(){
            var confirm_pass=document.getElementById('confirm_password').value
            var pass=document.getElementById('password').value

            if(confirm_pass==""){

                document.getElementById('confirm_password_error').innerHTML="password confirm required"
                confirm_password_check=false

            }
            else if(confirm_pass != pass){

                document.getElementById('confirm_password_error').innerHTML="password mismatch"
                confirm_password_check=false

            }            
            else{

                document.getElementById('confirm_password_error').innerHTML=""

                confirm_password_check=true
            }
         
            if (email_check == true && password_check == true){
                document.getElementById('display_error').innerHTML=""

            }

        }                           
    </script>
    {% endblock content %}